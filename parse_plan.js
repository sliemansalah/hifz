const fs = require('fs');
const path = require('path');

const content = fs.readFileSync(path.join(__dirname, '\u062e\u0637\u0629_\u062d\u0641\u0638_\u0627\u0644\u0642\u0631\u0622\u0646_\u0627\u0644\u0643\u0631\u064a\u0645.md'), 'utf-8');
const lines = content.split('\n');

const surahMap = {
  '\u0627\u0644\u0641\u0627\u062a\u062d\u0629': 1, '\u0627\u0644\u0628\u0642\u0631\u0629': 2, '\u0622\u0644 \u0639\u0645\u0631\u0627\u0646': 3,
  '\u0627\u0644\u0646\u0633\u0627\u0621': 4, '\u0627\u0644\u0645\u0627\u0626\u062f\u0629': 5, '\u0627\u0644\u0623\u0646\u0639\u0627\u0645': 6,
  '\u0627\u0644\u0623\u0639\u0631\u0627\u0641': 7, '\u0627\u0644\u0623\u0646\u0641\u0627\u0644': 8, '\u0627\u0644\u062a\u0648\u0628\u0629': 9,
  '\u064a\u0648\u0646\u0633': 10, '\u0647\u0648\u062f': 11, '\u064a\u0648\u0633\u0641': 12,
  '\u0627\u0644\u0631\u0639\u062f': 13, '\u0625\u0628\u0631\u0627\u0647\u064a\u0645': 14, '\u0627\u0644\u062d\u062c\u0631': 15,
  '\u0627\u0644\u0646\u062d\u0644': 16, '\u0627\u0644\u0625\u0633\u0631\u0627\u0621': 17, '\u0627\u0644\u0643\u0647\u0641': 18,
  '\u0645\u0631\u064a\u0645': 19, '\u0637\u0647': 20, '\u0627\u0644\u0623\u0646\u0628\u064a\u0627\u0621': 21,
  '\u0627\u0644\u062d\u062c': 22, '\u0627\u0644\u0645\u0624\u0645\u0646\u0648\u0646': 23, '\u0627\u0644\u0646\u0648\u0631': 24,
  '\u0627\u0644\u0641\u0631\u0642\u0627\u0646': 25, '\u0627\u0644\u0634\u0639\u0631\u0627\u0621': 26, '\u0627\u0644\u0646\u0645\u0644': 27,
  '\u0627\u0644\u0642\u0635\u0635': 28, '\u0627\u0644\u0639\u0646\u0643\u0628\u0648\u062a': 29, '\u0627\u0644\u0631\u0648\u0645': 30,
  '\u0644\u0642\u0645\u0627\u0646': 31, '\u0627\u0644\u0633\u062c\u062f\u0629': 32, '\u0627\u0644\u0623\u062d\u0632\u0627\u0628': 33,
  '\u0633\u0628\u0623': 34, '\u0641\u0627\u0637\u0631': 35, '\u064a\u0633': 36,
  '\u0627\u0644\u0635\u0627\u0641\u0627\u062a': 37, '\u0635': 38, '\u0627\u0644\u0632\u0645\u0631': 39,
  '\u063a\u0627\u0641\u0631': 40, '\u0641\u0635\u0644\u062a': 41, '\u0627\u0644\u0634\u0648\u0631\u0649': 42,
  '\u0627\u0644\u0632\u062e\u0631\u0641': 43, '\u0627\u0644\u062f\u062e\u0627\u0646': 44, '\u0627\u0644\u062c\u0627\u062b\u064a\u0629': 45,
  '\u0627\u0644\u0623\u062d\u0642\u0627\u0641': 46, '\u0645\u062d\u0645\u062f': 47, '\u0627\u0644\u0641\u062a\u062d': 48,
  '\u0627\u0644\u062d\u062c\u0631\u0627\u062a': 49, '\u0642': 50, '\u0627\u0644\u0630\u0627\u0631\u064a\u0627\u062a': 51,
  '\u0627\u0644\u0637\u0648\u0631': 52, '\u0627\u0644\u0646\u062c\u0645': 53, '\u0627\u0644\u0642\u0645\u0631': 54,
  '\u0627\u0644\u0631\u062d\u0645\u0646': 55, '\u0627\u0644\u0648\u0627\u0642\u0639\u0629': 56, '\u0627\u0644\u062d\u062f\u064a\u062f': 57,
  '\u0627\u0644\u0645\u062c\u0627\u062f\u0644\u0629': 58, '\u0627\u0644\u062d\u0634\u0631': 59, '\u0627\u0644\u0645\u0645\u062a\u062d\u0646\u0629': 60,
  '\u0627\u0644\u0635\u0641': 61, '\u0627\u0644\u062c\u0645\u0639\u0629': 62, '\u0627\u0644\u0645\u0646\u0627\u0641\u0642\u0648\u0646': 63,
  '\u0627\u0644\u062a\u063a\u0627\u0628\u0646': 64, '\u0627\u0644\u0637\u0644\u0627\u0642': 65, '\u0627\u0644\u062a\u062d\u0631\u064a\u0645': 66,
  '\u0627\u0644\u0645\u0644\u0643': 67, '\u0627\u0644\u0642\u0644\u0645': 68, '\u0627\u0644\u062d\u0627\u0642\u0629': 69,
  '\u0627\u0644\u0645\u0639\u0627\u0631\u062c': 70, '\u0646\u0648\u062d': 71, '\u0627\u0644\u062c\u0646': 72,
  '\u0627\u0644\u0645\u0632\u0645\u0644': 73, '\u0627\u0644\u0645\u062f\u062b\u0631': 74, '\u0627\u0644\u0642\u064a\u0627\u0645\u0629': 75,
  '\u0627\u0644\u0625\u0646\u0633\u0627\u0646': 76, '\u0627\u0644\u0645\u0631\u0633\u0644\u0627\u062a': 77, '\u0627\u0644\u0646\u0628\u0623': 78,
  '\u0627\u0644\u0646\u0627\u0632\u0639\u0627\u062a': 79, '\u0639\u0628\u0633': 80, '\u0627\u0644\u062a\u0643\u0648\u064a\u0631': 81,
  '\u0627\u0644\u0627\u0646\u0641\u0637\u0627\u0631': 82, '\u0627\u0644\u0645\u0637\u0641\u0641\u064a\u0646': 83, '\u0627\u0644\u0627\u0646\u0634\u0642\u0627\u0642': 84,
  '\u0627\u0644\u0628\u0631\u0648\u062c': 85, '\u0627\u0644\u0637\u0627\u0631\u0642': 86, '\u0627\u0644\u0623\u0639\u0644\u0649': 87,
  '\u0627\u0644\u063a\u0627\u0634\u064a\u0629': 88, '\u0627\u0644\u0641\u062c\u0631': 89, '\u0627\u0644\u0628\u0644\u062f': 90,
  '\u0627\u0644\u0634\u0645\u0633': 91, '\u0627\u0644\u0644\u064a\u0644': 92, '\u0627\u0644\u0636\u062d\u0649': 93,
  '\u0627\u0644\u0634\u0631\u062d': 94, '\u0627\u0644\u062a\u064a\u0646': 95, '\u0627\u0644\u0639\u0644\u0642': 96,
  '\u0627\u0644\u0642\u062f\u0631': 97, '\u0627\u0644\u0628\u064a\u0646\u0629': 98, '\u0627\u0644\u0632\u0644\u0632\u0644\u0629': 99,
  '\u0627\u0644\u0639\u0627\u062f\u064a\u0627\u062a': 100, '\u0627\u0644\u0642\u0627\u0631\u0639\u0629': 101, '\u0627\u0644\u062a\u0643\u0627\u062b\u0631': 102,
  '\u0627\u0644\u0639\u0635\u0631': 103, '\u0627\u0644\u0647\u0645\u0632\u0629': 104, '\u0627\u0644\u0641\u064a\u0644': 105,
  '\u0642\u0631\u064a\u0634': 106, '\u0627\u0644\u0645\u0627\u0639\u0648\u0646': 107, '\u0627\u0644\u0643\u0648\u062b\u0631': 108,
  '\u0627\u0644\u0643\u0627\u0641\u0631\u0648\u0646': 109, '\u0627\u0644\u0646\u0635\u0631': 110, '\u0627\u0644\u0645\u0633\u062f': 111,
  '\u0627\u0644\u0625\u062e\u0644\u0627\u0635': 112, '\u0627\u0644\u0641\u0644\u0642': 113, '\u0627\u0644\u0646\u0627\u0633': 114,
};

const planDays = [];
const fridayReviews = [];
const monthlyReviews = [];
let currentJuz = 0;
let lastDayNumber = 0;

for (const line of lines) {
  const juzMatch = line.match(/###\s*\u{1F4D7}\s*\u0627\u0644\u062c\u0632\u0621\s*(\d+)/u);
  if (juzMatch) { currentJuz = parseInt(juzMatch[1]); continue; }
  if (!line.startsWith('|')) continue;
  const cells = line.split('|').map(c => c.trim()).filter(c => c !== '');
  if (cells.length < 7) continue;
  const first = cells[0];
  if (first === '\u{1F54C}') { fridayReviews.push({ afterDay: lastDayNumber, juz: currentJuz }); continue; }
  if (first === '\u{1F4CB}') {
    const mm = cells[1].match(/\u0627\u0644\u0634\u0647\u0631\s*(\d+)/);
    if (mm) monthlyReviews.push({ month: parseInt(mm[1]), afterDay: lastDayNumber });
    continue;
  }
  const dayNum = parseInt(first);
  if (isNaN(dayNum)) continue;
  const surahName = cells[1].replace(/\*\*/g, '').trim();
  const startAyah = parseInt(cells[2]);
  const endAyah = parseInt(cells[3]);
  const ayahCount = parseInt(cells[4]);
  const nearReview = cells[6] || '\u2014';
  const surahNumber = surahMap[surahName] || 0;
  planDays.push({ dayNumber: dayNum, juz: currentJuz, surahName, surahNumber, startAyah, endAyah, ayahCount, nearReview });
  lastDayNumber = dayNum;
}

// Build surahNumbers map string with readable Arabic
const surahEntries = [
  ["'\u0627\u0644\u0641\u0627\u062a\u062d\u0629'", 1], ["'\u0627\u0644\u0628\u0642\u0631\u0629'", 2], ["'\u0622\u0644 \u0639\u0645\u0631\u0627\u0646'", 3],
  ["'\u0627\u0644\u0646\u0633\u0627\u0621'", 4], ["'\u0627\u0644\u0645\u0627\u0626\u062f\u0629'", 5], ["'\u0627\u0644\u0623\u0646\u0639\u0627\u0645'", 6],
  ["'\u0627\u0644\u0623\u0639\u0631\u0627\u0641'", 7], ["'\u0627\u0644\u0623\u0646\u0641\u0627\u0644'", 8], ["'\u0627\u0644\u062a\u0648\u0628\u0629'", 9],
  ["'\u064a\u0648\u0646\u0633'", 10], ["'\u0647\u0648\u062f'", 11], ["'\u064a\u0648\u0633\u0641'", 12],
  ["'\u0627\u0644\u0631\u0639\u062f'", 13], ["'\u0625\u0628\u0631\u0627\u0647\u064a\u0645'", 14], ["'\u0627\u0644\u062d\u062c\u0631'", 15],
  ["'\u0627\u0644\u0646\u062d\u0644'", 16], ["'\u0627\u0644\u0625\u0633\u0631\u0627\u0621'", 17], ["'\u0627\u0644\u0643\u0647\u0641'", 18],
  ["'\u0645\u0631\u064a\u0645'", 19], ["'\u0637\u0647'", 20], ["'\u0627\u0644\u0623\u0646\u0628\u064a\u0627\u0621'", 21],
  ["'\u0627\u0644\u062d\u062c'", 22], ["'\u0627\u0644\u0645\u0624\u0645\u0646\u0648\u0646'", 23], ["'\u0627\u0644\u0646\u0648\u0631'", 24],
  ["'\u0627\u0644\u0641\u0631\u0642\u0627\u0646'", 25], ["'\u0627\u0644\u0634\u0639\u0631\u0627\u0621'", 26], ["'\u0627\u0644\u0646\u0645\u0644'", 27],
  ["'\u0627\u0644\u0642\u0635\u0635'", 28], ["'\u0627\u0644\u0639\u0646\u0643\u0628\u0648\u062a'", 29], ["'\u0627\u0644\u0631\u0648\u0645'", 30],
  ["'\u0644\u0642\u0645\u0627\u0646'", 31], ["'\u0627\u0644\u0633\u062c\u062f\u0629'", 32], ["'\u0627\u0644\u0623\u062d\u0632\u0627\u0628'", 33],
  ["'\u0633\u0628\u0623'", 34], ["'\u0641\u0627\u0637\u0631'", 35], ["'\u064a\u0633'", 36],
  ["'\u0627\u0644\u0635\u0627\u0641\u0627\u062a'", 37], ["'\u0635'", 38], ["'\u0627\u0644\u0632\u0645\u0631'", 39],
  ["'\u063a\u0627\u0641\u0631'", 40], ["'\u0641\u0635\u0644\u062a'", 41], ["'\u0627\u0644\u0634\u0648\u0631\u0649'", 42],
  ["'\u0627\u0644\u0632\u062e\u0631\u0641'", 43], ["'\u0627\u0644\u062f\u062e\u0627\u0646'", 44], ["'\u0627\u0644\u062c\u0627\u062b\u064a\u0629'", 45],
  ["'\u0627\u0644\u0623\u062d\u0642\u0627\u0641'", 46], ["'\u0645\u062d\u0645\u062f'", 47], ["'\u0627\u0644\u0641\u062a\u062d'", 48],
  ["'\u0627\u0644\u062d\u062c\u0631\u0627\u062a'", 49], ["'\u0642'", 50], ["'\u0627\u0644\u0630\u0627\u0631\u064a\u0627\u062a'", 51],
  ["'\u0627\u0644\u0637\u0648\u0631'", 52], ["'\u0627\u0644\u0646\u062c\u0645'", 53], ["'\u0627\u0644\u0642\u0645\u0631'", 54],
  ["'\u0627\u0644\u0631\u062d\u0645\u0646'", 55], ["'\u0627\u0644\u0648\u0627\u0642\u0639\u0629'", 56], ["'\u0627\u0644\u062d\u062f\u064a\u062f'", 57],
  ["'\u0627\u0644\u0645\u062c\u0627\u062f\u0644\u0629'", 58], ["'\u0627\u0644\u062d\u0634\u0631'", 59], ["'\u0627\u0644\u0645\u0645\u062a\u062d\u0646\u0629'", 60],
  ["'\u0627\u0644\u0635\u0641'", 61], ["'\u0627\u0644\u062c\u0645\u0639\u0629'", 62], ["'\u0627\u0644\u0645\u0646\u0627\u0641\u0642\u0648\u0646'", 63],
  ["'\u0627\u0644\u062a\u063a\u0627\u0628\u0646'", 64], ["'\u0627\u0644\u0637\u0644\u0627\u0642'", 65], ["'\u0627\u0644\u062a\u062d\u0631\u064a\u0645'", 66],
  ["'\u0627\u0644\u0645\u0644\u0643'", 67], ["'\u0627\u0644\u0642\u0644\u0645'", 68], ["'\u0627\u0644\u062d\u0627\u0642\u0629'", 69],
  ["'\u0627\u0644\u0645\u0639\u0627\u0631\u062c'", 70], ["'\u0646\u0648\u062d'", 71], ["'\u0627\u0644\u062c\u0646'", 72],
  ["'\u0627\u0644\u0645\u0632\u0645\u0644'", 73], ["'\u0627\u0644\u0645\u062f\u062b\u0631'", 74], ["'\u0627\u0644\u0642\u064a\u0627\u0645\u0629'", 75],
  ["'\u0627\u0644\u0625\u0646\u0633\u0627\u0646'", 76], ["'\u0627\u0644\u0645\u0631\u0633\u0644\u0627\u062a'", 77], ["'\u0627\u0644\u0646\u0628\u0623'", 78],
  ["'\u0627\u0644\u0646\u0627\u0632\u0639\u0627\u062a'", 79], ["'\u0639\u0628\u0633'", 80], ["'\u0627\u0644\u062a\u0643\u0648\u064a\u0631'", 81],
  ["'\u0627\u0644\u0627\u0646\u0641\u0637\u0627\u0631'", 82], ["'\u0627\u0644\u0645\u0637\u0641\u0641\u064a\u0646'", 83], ["'\u0627\u0644\u0627\u0646\u0634\u0642\u0627\u0642'", 84],
  ["'\u0627\u0644\u0628\u0631\u0648\u062c'", 85], ["'\u0627\u0644\u0637\u0627\u0631\u0642'", 86], ["'\u0627\u0644\u0623\u0639\u0644\u0649'", 87],
  ["'\u0627\u0644\u063a\u0627\u0634\u064a\u0629'", 88], ["'\u0627\u0644\u0641\u062c\u0631'", 89], ["'\u0627\u0644\u0628\u0644\u062f'", 90],
  ["'\u0627\u0644\u0634\u0645\u0633'", 91], ["'\u0627\u0644\u0644\u064a\u0644'", 92], ["'\u0627\u0644\u0636\u062d\u0649'", 93],
  ["'\u0627\u0644\u0634\u0631\u062d'", 94], ["'\u0627\u0644\u062a\u064a\u0646'", 95], ["'\u0627\u0644\u0639\u0644\u0642'", 96],
  ["'\u0627\u0644\u0642\u062f\u0631'", 97], ["'\u0627\u0644\u0628\u064a\u0646\u0629'", 98], ["'\u0627\u0644\u0632\u0644\u0632\u0644\u0629'", 99],
  ["'\u0627\u0644\u0639\u0627\u062f\u064a\u0627\u062a'", 100], ["'\u0627\u0644\u0642\u0627\u0631\u0639\u0629'", 101], ["'\u0627\u0644\u062a\u0643\u0627\u062b\u0631'", 102],
  ["'\u0627\u0644\u0639\u0635\u0631'", 103], ["'\u0627\u0644\u0647\u0645\u0632\u0629'", 104], ["'\u0627\u0644\u0641\u064a\u0644'", 105],
  ["'\u0642\u0631\u064a\u0634'", 106], ["'\u0627\u0644\u0645\u0627\u0639\u0648\u0646'", 107], ["'\u0627\u0644\u0643\u0648\u062b\u0631'", 108],
  ["'\u0627\u0644\u0643\u0627\u0641\u0631\u0648\u0646'", 109], ["'\u0627\u0644\u0646\u0635\u0631'", 110], ["'\u0627\u0644\u0645\u0633\u062f'", 111],
  ["'\u0627\u0644\u0625\u062e\u0644\u0627\u0635'", 112], ["'\u0627\u0644\u0641\u0644\u0642'", 113], ["'\u0627\u0644\u0646\u0627\u0633'", 114],
];

let out = `import { PlanDay } from '@/types/plan';

// Mapping of Arabic surah names to numbers
const surahNumbers: Record<string, number> = {\n`;
for (const [k, v] of surahEntries) out += `  ${k}: ${v},\n`;
out += `};\n\nexport const planDays: PlanDay[] = [\n`;
for (const d of planDays) {
  const nr = d.nearReview.replace(/'/g, "\\'");
  out += `  { dayNumber: ${d.dayNumber}, juz: ${d.juz}, surahName: '${d.surahName}', surahNumber: ${d.surahNumber}, startAyah: ${d.startAyah}, endAyah: ${d.endAyah}, ayahCount: ${d.ayahCount}, nearReview: '${nr}' },\n`;
}
out += `];\n\nexport const fridayReviews: { afterDay: number; juz: number }[] = [\n`;
for (const f of fridayReviews) out += `  { afterDay: ${f.afterDay}, juz: ${f.juz} },\n`;
out += `];\n\nexport const monthlyReviews: { month: number; afterDay: number }[] = [\n`;
for (const m of monthlyReviews) out += `  { month: ${m.month}, afterDay: ${m.afterDay} },\n`;
out += `];\n\n`;
out += `export function getDaysByJuz(juz: number): PlanDay[] {
  return planDays.filter(d => d.juz === juz);
}

export function getDay(dayNumber: number): PlanDay | undefined {
  return planDays.find(d => d.dayNumber === dayNumber);
}

export const TOTAL_DAYS = ${planDays.length};
export const TOTAL_JUZ = 30;
`;

fs.writeFileSync(path.join(__dirname, 'src', 'data', 'plan.ts'), out, 'utf-8');
console.log('Days:', planDays.length, 'Fridays:', fridayReviews.length, 'Monthly:', monthlyReviews.length);
console.log('First:', JSON.stringify(planDays[0]));
console.log('Last:', JSON.stringify(planDays[planDays.length - 1]));
